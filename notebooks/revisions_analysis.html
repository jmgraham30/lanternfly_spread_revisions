<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Possible Analyses for Revisions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="revisions_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="revisions_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="revisions_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="revisions_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="revisions_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="revisions_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="revisions_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="revisions_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="revisions_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="revisions_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Possible Analyses for Revisions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Using data collected on infestation by the spotted laternfly across 166 counties in the Mid-Atlantic region of the United States, we are interested to know about factors that likely contribute to spread of the organism. Here, we focus on factors related to human activity and that can be targeted for control or mitigation measures. The factors we focus on are:</p>
<ul>
<li><p>The number of businesses designated as garden centers in a county.</p></li>
<li><p>The number of two-digit interstate highways that transect a county.</p></li>
</ul>
<p>Further, we also examine the influence of the county population as previous work has established this as an important contributor to lanternfly spread.</p>
<p>A reasonable question: does the data provide evidence that the transportation of materials sold at garden centers over interstate highways contribute to the spread of the spotted laternfly?</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The Data</h2>
<p><a href="#tbl-data">Table&nbsp;1</a> displays the first few rows of the data collected for the 166 county Mid-Atlantic region.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-data" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;1: Data collected for the 166 county Mid-Atlantic region.</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">infested</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">county</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">state</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nis</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">suffolk</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">1477000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">nassau</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">1357000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">fairfield</td>
<td style="text-align: left;">CT</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">943332</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">ocean</td>
<td style="text-align: left;">NJ</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">607186</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">queens</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2253858</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2014</td>
<td style="text-align: left;">kings</td>
<td style="text-align: left;">NY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">2559903</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>For analysis, we add to this data the boundaries for all included counties.</p>
<p><a href="#fig-figure-1">Figure&nbsp;1</a> displays the 2021 infestation status for the 166 Mid-Atlantic region counties in 2021:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-figure-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="revisions_analysis_files/figure-html/fig-figure-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Counties in the defined Mid-Atlantic regions that were designated as infested by the spotted laternfly in 2021.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="initial-exploratoration-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="initial-exploratoration-of-the-data">Initial Exploratoration of the Data</h2>
<p><a href="#tbl-infestations">Table&nbsp;2</a> displays the number of counties per year in the defined Mid-Atlantic region of 166 that were listed as infected.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-infestations" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;2: The number of counties per year in the defined Mid-Atlantic region of 166 that were listed as infected.</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Number Infested</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2019</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: right;">2021</td>
<td style="text-align: right;">88</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#fig-figure-3">Figure&nbsp;2</a> shows the 166 counties in the defined Mid-Atlantic region together with their 2021 infestation status and the number of two-digit interstate highways that transect the county.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-figure-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="revisions_analysis_files/figure-html/fig-figure-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Spotted laternfly infested counties for 2021 together with the number of two-digit interstate highways transecting the counties.</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-figure-4">Figure&nbsp;3</a> shows the 166 counties in the defined Mid-Atlantic region together with their 2021 infestation status and the number of garden centers in the county.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-figure-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="revisions_analysis_files/figure-html/fig-figure-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Spotted laternfly infested counties for 2021 together with the number of garden centers in the counties.</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-figure-5">Figure&nbsp;4</a> shows the 166 counties in the defined Mid-Atlantic region together with their 2021 infestation status and the county population on the log scale as estimated in 2019.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-figure-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="revisions_analysis_files/figure-html/fig-figure-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Spotted laternfly infested counties for 2021 together with the 2019 estimated population (log scale) for the counties.</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-figure-6">Figure&nbsp;5</a> shows the 166 counties in the defined Mid-Atlantic region together with the presence/absence of two-digit interstate highways and the number of garden center per county.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-figure-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="revisions_analysis_files/figure-html/fig-figure-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Spotted laternfly infested counties for 2021 together with the presence/absence of two-digit interstate highways and the number of garden center per county.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-analysis" class="level2">
<h2 class="anchored" data-anchor-id="statistical-analysis">Statistical Analysis</h2>
<p>For a statistical test of our hypothesis, we have use R version 4.3.1 and package <code>mgcv</code> to fit a generalized additive model <span class="citation" data-cites="rcore wood2003 wood2017generalized">(<a href="#ref-rcore" role="doc-biblioref">R Core Team 2023</a>; <a href="#ref-wood2003" role="doc-biblioref">S. N. Wood 2003</a>; <a href="#ref-wood2017generalized" role="doc-biblioref">Simon N. Wood 2017</a>)</span>. Specifically, we model the log odds of county infestation in 2021 with tensor product smoothing for longitude and latitude to control for spatial autocorrelation with linear predictors: presence/absence of two-digit interstate highway, number of garden centers, 2019 county population, and an interaction term for presence/absence of two-digit interstate highway and number of garden centers. To deal with issues of convergence and variables of different scale, we log transformed the population and centered and scaled the number of garden centers. We used the packages <code>DHARMa</code> and <code>gratia</code> for diagnostics of model assumptions <span class="citation" data-cites="dharma2022 gratia2023">(<a href="#ref-dharma2022" role="doc-biblioref">Hartig 2022</a> ; <a href="#ref-gratia2023" role="doc-biblioref">Simpson 2023</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod_form_21 <span class="ot">&lt;-</span> infested <span class="sc">~</span> is_presence <span class="sc">+</span> std_gc <span class="sc">+</span> is_presence<span class="sc">:</span>std_gc <span class="sc">+</span> pop_log <span class="sc">+</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">te</span>(longitude,latitude)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>gam_mod_21 <span class="ot">&lt;-</span> <span class="fu">gam</span>(mod_form_21,<span class="at">data=</span>data_1,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">"REML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#tbl-mod-summ">Table&nbsp;3</a> summarizes the estimated coefficients for the linear predictors in the generalized additive model.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-mod-summ" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;3: Summary table for estimates for linear terms in generalized additive model.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Coefficient</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">-8.794628</td>
<td style="text-align: right;">4.2781470</td>
<td style="text-align: right;">0.0398105</td>
</tr>
<tr class="even">
<td style="text-align: left;">IS Presence - Yes</td>
<td style="text-align: right;">1.207274</td>
<td style="text-align: right;">0.6253652</td>
<td style="text-align: right;">0.0535437</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garden Centers</td>
<td style="text-align: right;">-1.286439</td>
<td style="text-align: right;">0.6280036</td>
<td style="text-align: right;">0.0405151</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pop (log)</td>
<td style="text-align: right;">1.679994</td>
<td style="text-align: right;">0.8431980</td>
<td style="text-align: right;">0.0463264</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IS Presence - Yes : Garden Centers</td>
<td style="text-align: right;">1.959781</td>
<td style="text-align: right;">0.6944467</td>
<td style="text-align: right;">0.0047714</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-dharma2022" class="csl-entry" role="listitem">
Hartig, Florian. 2022. <em>DHARMa: Residual Diagnostics for Hierarchical (Multi-Level / Mixed) Regression Models</em>. <a href="https://CRAN.R-project.org/package=DHARMa">https://CRAN.R-project.org/package=DHARMa</a>.
</div>
<div id="ref-rcore" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-gratia2023" class="csl-entry" role="listitem">
Simpson, Gavin L. 2023. <em><span class="nocase">gratia</span>: Graceful <span class="nocase">ggplot</span>-Based Graphics and Other Functions for <span>GAM</span>s Fitted Using <span class="nocase">mgcv</span></em>. <a href="https://gavinsimpson.github.io/gratia/">https://gavinsimpson.github.io/gratia/</a>.
</div>
<div id="ref-wood2003" class="csl-entry" role="listitem">
Wood, S. N. 2003. <span>“Thin-Plate Regression Splines.”</span> <em>Journal of the Royal Statistical Society (B)</em> 65 (1): 95–114.
</div>
<div id="ref-wood2017generalized" class="csl-entry" role="listitem">
Wood, Simon N. 2017. <em>Generalized Additive Models: An Introduction with r</em>. CRC press.
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand for Session Info
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.1 (2023-06-16)
 os       macOS Ventura 13.5.2
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/New_York
 date     2023-09-17
 pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
 quarto   1.3.450 @ /usr/local/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package     * version  date (UTC) lib source
 broom.mixed * 0.2.9.4  2022-04-17 [1] CRAN (R 4.3.0)
 DHARMa      * 0.4.6    2022-09-08 [1] CRAN (R 4.3.0)
 dplyr       * 1.1.3    2023-09-03 [1] CRAN (R 4.3.0)
 forcats     * 1.0.0    2023-01-29 [1] CRAN (R 4.3.0)
 ggplot2     * 3.4.3    2023-08-14 [1] CRAN (R 4.3.0)
 gratia      * 0.8.1.34 2023-07-02 [1] Github (gavinsimpson/gratia@f967268)
 kableExtra  * 1.3.4    2021-02-20 [1] CRAN (R 4.3.0)
 lubridate   * 1.9.2    2023-02-10 [1] CRAN (R 4.3.0)
 mgcv        * 1.9-0    2023-07-11 [1] CRAN (R 4.3.0)
 nlme        * 3.1-163  2023-08-09 [1] CRAN (R 4.3.0)
 purrr       * 1.0.2    2023-08-10 [1] CRAN (R 4.3.0)
 readr       * 2.1.4    2023-02-10 [1] CRAN (R 4.3.0)
 sessioninfo * 1.2.2    2021-12-06 [1] CRAN (R 4.3.0)
 stringr     * 1.5.0    2022-12-02 [1] CRAN (R 4.3.0)
 tibble      * 3.2.1    2023-03-20 [1] CRAN (R 4.3.0)
 tidyr       * 1.3.0    2023-01-24 [1] CRAN (R 4.3.0)
 tidyverse   * 2.0.0    2023-02-22 [1] CRAN (R 4.3.0)

 [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>